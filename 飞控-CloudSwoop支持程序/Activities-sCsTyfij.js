import{p as G,r as _,d as y,q as L,x as i,u as c,z as e,C as d,F as x,A as u,J as b,y as Y,B as a,H as f,I as k,S as P,G as U}from"./vendor-vue-Jnuf10aA.js";import{u as q}from"./index-fzwUdIyg.js";import{g as J}from"./activities-zgyOHQdj.js";import{d as m}from"./dayjs.min-C1j0t_Vm.js";import{p as Q,R as K,O as W,Q as X,s as Z,u as ee,l as te,h as se}from"./vendor-ui-B2Co-fxL.js";import"./vendor-utils-BslDH373.js";const ae={class:"min-h-screen linear-animate-in",style:{background:"var(--linear-bg-secondary)"}},re={class:"linear-navbar linear-animate-slide-down"},ne={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},oe={class:"flex items-center justify-between"},le={class:"text-2xl font-bold flex items-center linear-animate-float",style:{color:"var(--linear-text-primary)"}},ie={class:"flex items-center space-x-3"},ce=["disabled"],de={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},ue={class:"linear-card p-6 mb-6 linear-animate-slide-down",style:{"animation-delay":"0.1s"}},me={class:"flex items-center justify-between"},ve={class:"flex items-center space-x-4"},xe={class:"text-xl font-semibold",style:{color:"var(--linear-text-primary)"}},ge={class:"linear-card linear-animate-scale",style:{"animation-delay":"0.2s"}},he={class:"p-6"},be={class:"grid grid-cols-7 gap-1 mb-4"},pe={class:"grid grid-cols-7 gap-1"},_e=["onClick"],ye={class:"space-y-1"},fe=["title","onClick"],ke={key:0,class:"text-xs text-gray-500 px-2"},we={key:0,class:"linear-card mt-6 linear-animate-scale",style:{"animation-delay":"0.3s"}},Ce={class:"p-6 border-b",style:{"border-color":"var(--linear-border)"}},Me={class:"text-lg font-semibold",style:{color:"var(--linear-text-primary)"}},Ye={class:"p-6"},Se={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},De=["onClick"],Te={class:"flex items-start justify-between mb-2"},Ae={class:"font-semibold text-sm",style:{color:"var(--linear-text-primary)"}},Oe={class:"space-y-1 text-xs",style:{color:"var(--linear-text-secondary)"}},Be={class:"flex items-center"},Re={class:"flex items-center"},Ve={class:"flex items-center space-x-3 mt-2"},je={class:"flex items-center"},Ie={class:"flex items-center"},Le=G({__name:"Activities",setup(Ne){const S=U();q();const p=_(!1),g=_([]),o=_(m()),v=_(null),D=["日","一","二","三","四","五","六"],T=y(()=>o.value.format("YYYY年MM月")),A=y(()=>v.value?v.value.format("YYYY年MM月DD日"):""),O=y(()=>{const s=o.value.startOf("month"),r=o.value.endOf("month"),t=s.startOf("week"),l=r.endOf("week"),C=[];let n=t;for(;n.isBefore(l)||n.isSame(l,"day");){const z=g.value.filter(F=>m(F.active_time).isSame(n,"day"));C.push({date:n,day:n.date(),dateString:n.format("YYYY-MM-DD"),isCurrentMonth:n.isSame(o.value,"month"),isToday:n.isSame(m(),"day"),activities:z}),n=n.add(1,"day")}return C}),w=y(()=>v.value?g.value.filter(s=>m(s.active_time).isSame(v.value,"day")):[]),h=async()=>{p.value=!0;try{const s=o.value.format("YYYY-MM"),r=await J(s);r.code==="GET_ACTIVITIES"&&r.data?g.value=Array.isArray(r.data)?r.data:[]:g.value=[]}catch{g.value=[]}finally{p.value=!1}},B=s=>{v.value=s.date},R=()=>{o.value=m(),v.value=m(),h()},V=()=>{h()},j=()=>{o.value=o.value.subtract(1,"month"),h()},I=()=>{o.value=o.value.add(1,"month"),h()},M=s=>{S.push(`/activity/${s.id}`)},N=s=>{switch(s){case 0:return"bg-green-200 text-green-800 dark:bg-green-800 dark:text-green-200";case 1:return"bg-blue-200 text-blue-800 dark:bg-blue-800 dark:text-blue-200";case 2:return"bg-red-200 text-red-800 dark:bg-red-800 dark:text-red-200";default:return"bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-300"}},$=s=>{switch(s){case 0:return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400";case 1:return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400";case 2:return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}},E=s=>{switch(s){case 0:return"报名中";case 1:return"活动中";case 2:return"已结束";default:return"未知"}},H=s=>m(s).format("HH:mm");return L(()=>{h()}),(s,r)=>(c(),i("div",ae,[e("div",re,[e("div",ne,[e("div",oe,[e("div",null,[e("h1",le,[d(u(Q),{class:"w-6 h-6 mr-3",style:{color:"var(--linear-accent)"}}),r[0]||(r[0]=x(" 活动日历 ",-1))]),r[1]||(r[1]=e("p",{class:"mt-1 text-sm",style:{color:"var(--linear-text-secondary)"}}," 查看和参与CloudSwoop飞行活动 ",-1))]),e("div",ie,[e("button",{onClick:V,disabled:p.value,class:"linear-btn linear-btn-secondary"},[d(u(K),{class:b(["w-4 h-4 mr-2",{"animate-spin":p.value}])},null,8,["class"]),r[2]||(r[2]=x(" 刷新数据 ",-1))],8,ce)])])])]),e("div",de,[e("div",ue,[e("div",me,[e("div",ve,[e("button",{onClick:j,class:"linear-btn linear-btn-ghost p-2"},[d(u(W),{class:"w-4 h-4"})]),e("h2",xe,a(T.value),1),e("button",{onClick:I,class:"linear-btn linear-btn-ghost p-2"},[d(u(X),{class:"w-4 h-4"})])]),e("div",{class:"flex items-center space-x-2"},[e("button",{onClick:R,class:"linear-btn linear-btn-ghost text-sm"}," 今天 ")])])]),e("div",ge,[e("div",he,[e("div",be,[(c(),i(f,null,k(D,t=>e("div",{key:t,class:"text-center py-2 text-sm font-medium",style:{color:"var(--linear-text-secondary)"}},a(t),1)),64))]),e("div",pe,[(c(!0),i(f,null,k(O.value,t=>(c(),i("div",{key:t.dateString,class:b(["relative min-h-[120px] p-2 border rounded-lg cursor-pointer transition-all hover:bg-linear-bg-secondary/50",t.isCurrentMonth?"border-linear-border":"border-transparent opacity-30",t.isToday?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800":"",t.activities.length>0?"bg-green-50 dark:bg-green-900/20":""]),onClick:l=>B(t)},[e("div",{class:b(["text-sm font-medium mb-1",t.isToday?"text-blue-600 dark:text-blue-400":"text-linear-text-primary"])},a(t.day),3),e("div",ye,[(c(!0),i(f,null,k(t.activities.slice(0,3),(l,C)=>(c(),i("div",{key:l.id,class:b(["text-xs px-2 py-1 rounded truncate cursor-pointer hover:opacity-80 transition-opacity",N(l.status)]),title:l.title,onClick:P(n=>M(l),["stop"])},a(l.title),11,fe))),128)),t.activities.length>3?(c(),i("div",ke," +"+a(t.activities.length-3)+" 更多 ",1)):Y("",!0)])],10,_e))),128))])])]),w.value.length>0?(c(),i("div",we,[e("div",Ce,[e("h3",Me,a(A.value)+" 的活动 ("+a(w.value.length)+") ",1)]),e("div",Ye,[e("div",Se,[(c(!0),i(f,null,k(w.value,t=>(c(),i("div",{key:t.id,class:"border rounded-lg p-4 cursor-pointer hover:bg-linear-bg-secondary/50 transition-colors",style:{"border-color":"var(--linear-border)"},onClick:l=>M(t)},[e("div",Te,[e("h4",Ae,a(t.title),1),e("span",{class:b([$(t.status),"px-2 py-1 rounded-full text-xs font-medium"])},a(E(t.status)),3)]),e("div",Oe,[e("div",Be,[d(u(Z),{class:"w-3 h-3 mr-1"}),x(" "+a(H(t.active_time)),1)]),e("div",Re,[d(u(ee),{class:"w-3 h-3 mr-1"}),x(" "+a(t.departure_airport)+" → "+a(t.arrival_airport),1)]),e("div",Ve,[e("span",je,[d(u(te),{class:"w-3 h-3 mr-1"}),x(" "+a(t.pilots?.length||0),1)]),e("span",Ie,[d(u(se),{class:"w-3 h-3 mr-1"}),x(" "+a(t.controllers?.length||0),1)])])])],8,De))),128))])])])):Y("",!0)])]))}});export{Le as default};
